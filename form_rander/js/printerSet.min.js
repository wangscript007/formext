var printerSet={};$(function(a){util.bootstrapLodop(0,function(){document.getElementById("T5").value=util.PcSN;printerSet.CreatePrinterList();a(".Orient").append("\x3coption value\x3d'0'\x3e0---\u65b9\u5411\u4e0d\u5b9a\uff0c\u7531\u64cd\u4f5c\u8005\u81ea\u884c\u9009\u62e9\u6216\u6309\u6253\u5370\u673a\u7f3a\u7701\u8bbe\u7f6e\x3c/option\x3e\x3coption value\x3d'1'\x3e1---\u7eb5\u5411\u6253\u5370\uff0c\u56fa\u5b9a\u7eb8\u5f20\uff1b\x3c/option\x3e\x3coption value\x3d'2'\x3e2---\u6a2a\u5411\u6253\u5370\uff0c\u56fa\u5b9a\u7eb8\u5f20\uff1b\x3c/option\x3e\x3coption value\x3d'3'\x3e3---\u7eb5\u5411\u6253\u5370\uff0c\u5bbd\u5ea6\u56fa\u5b9a\uff0c\u9ad8\u5ea6\u6309\u6253\u5370\u5185\u5bb9\u7684\u9ad8\u5ea6\u81ea\u9002\u5e94\x3c/option\x3e");var c="select * from printersetup where PcID \x3d '{PcID}'".format({PcID:util.PcSN});a.getJSON(pageExt.libPath+"query.php",{sql:c},function(b,c,d){for(j=0;j<b.length;j++)util.getSelectOptionByText("#PrinterList"+b[j].PrinterType,b[j].PrinterName).attr("selected",!0),printerSet.CreatePagSizeList(j+1),util.getSelectOptionByValue("#Orient"+b[j].PrinterType,b[j].Orient).attr("selected",!0),util.getSelectOptionByText("#PagSizeList"+b[j].PrinterType,b[j].PageName).attr("selected",!0),a("#Width"+b[j].PrinterType).val(b[j].PageWidth),a("#Heigth"+b[j].PrinterType).val(b[j].PageHeigth)})});a(".PrinterList").change(function(){printerSet.CreatePagSizeList(a(this).attr("index"));a(this).css("background-color","#FFFFCC")})});printerSet.CreatePrinterList=function(){var a=LODOP.GET_PRINTER_COUNT();$(".PrinterList").append("\x3coption value\x3d'-1'\x3e#\u672a\u8bbe\u7f6e#\x3c/option\x3e");for(var c=0;c<a;c++){var b=document.createElement("option");b.innerHTML=LODOP.GET_PRINTER_NAME(c);b.value=c;$(".PrinterList").append(b)}};printerSet.CreatePagSizeList=function(a){$("#PagSizeList"+a).empty();var c;c=LODOP.GET_PAGESIZES_LIST($("#PrinterList"+a).val(),"\n").split("\n");$("#PagSizeList"+a).append("\x3coption value\x3d'-1'\x3e#\u672a\u8bbe\u7f6e#\x3c/option\x3e");for(i in c){var b=document.createElement("option");b.innerHTML=c[i];b.value=c[i];$("#PagSizeList"+a).append(b)}};printerSet.saveSetting=function(){for(var a=1;a<=$(".gridtable tr").length-1;a++)printerSet.singleSave(a);alert("\u4fdd\u5b58\u6210\u529f\uff01")};printerSet.singleSave=function(a){a="insert into printersetup(PcID, PrinterType, PrinterName, Orient, PageName, PageWidth, PageHeigth) values('{PcID}',{PrinterType},'{PrinterName}', {Orient}, '{PageName}', '{PageWidth}', '{PageHeigth}') ON DUPLICATE KEY UPDATE PrinterName\x3dVALUES(PrinterName),Orient\x3dVALUES(Orient),PageName\x3dVALUES(PageName),PageWidth\x3dVALUES(PageWidth),PageHeigth\x3dVALUES(PageHeigth);".format({PcID:$("#T5").val(),PrinterType:a,PrinterName:$("#PrinterList"+a).find("option:selected").text(),Orient:$("#Orient"+a).val(),PageName:$("#PagSizeList"+a).find("option:selected").text(),PageWidth:$("#Width"+a).val(),PageHeigth:$("#Heigth"+a).val()});$.post(pageExt.libPath+"exec2.php",{sql:a},function(a){},"json")};