var util={};String.prototype.format=function(a){var b=this;if(0<arguments.length)if(1==arguments.length&&"object"==typeof a)for(var c in a){a[c]=a[c]?a[c]:"";var d=new RegExp("({"+c+"})","g"),b=b.replace(d,a[c])}else for(var e=0;e<arguments.length;e++)arguments[c]=arguments[c]?arguments[c]:"",d=new RegExp("({)"+e+"(})","g"),b=b.replace(d,arguments[e]);return b};$(function(a){a.fn.extend({alterBgColor:function(b){b=a.extend({style:"4",odd:"odd",even:"even",over:"over",selected:"selected"},b);a("tbody\x3etr:odd",this).addClass(b.odd);a("tbody\x3etr:even",this).addClass(b.even);a("tbody\x3etr",this).hover(function(){a(this).addClass(b.over)},function(){a(this).removeClass(b.over)});a("tbody\x3etr td:first-child:has(:checked)",this).parents("tr").addClass(b.selected);"1"==b.style&&a("tbody\x3etr",this).click(function(){a(this).toggleClass(b.selected)});"2"==b.style&&a("tbody\x3etr",this).click(function(){var c=a(this).hasClass(b.selected);a(this)[c?"removeClass":"addClass"](b.selected).find(":checkbox:first").prop("checked",!c)});"3"==b.style&&a("tbody\x3etr",this).click(function(){a(this).siblings().removeClass(b.selected);a(this).addClass(b.selected).find(":radio:first").prop("checked",!0)});"4"==b.style&&(a("tbody\x3etr td:first-child",this).click(function(){var c=a(this).parents("tr"),d=c.hasClass(b.selected);c[d?"removeClass":"addClass"](b.selected).find(":checkbox:first").prop("checked",!d)}),a("tbody\x3etr td:not(:first-child)",this).click(function(){var c=a(this).parents("tr");c.addClass(b.selected).siblings().removeClass(b.selected).find(":checkbox:first").prop("checked",!1);c.find(":checkbox:first").prop("checked",!0)}));a("thead\x3etr th:first-child :checkbox:first",this).click(function(){var c=a(this).prop("checked"),d=a(this).parents("table");d.find("tbody\x3etr")[c?"addClass":"removeClass"](b.selected);d.find("tbody\x3etr td:first-child :checkbox").prop("checked",c?!0:!1)});return this}});a(".gridtable").alterBgColor({style:"4"});a.datepicker.regional["zh-CN"]={clearText:"\u6e05\u9664",clearStatus:"\u6e05\u9664\u5df2\u9009\u65e5\u671f",closeText:"\u5173\u95ed",closeStatus:"\u4e0d\u6539\u53d8\u5f53\u524d\u9009\u62e9",prevText:"\x3c \u4e0a\u6708",prevStatus:"\u663e\u793a\u4e0a\u6708",prevBigText:"\x3c\x3c",prevBigStatus:"\u663e\u793a\u4e0a\u4e00\u5e74",nextText:"\u4e0b\u6708\x3e",nextStatus:"\u663e\u793a\u4e0b\u6708",nextBigText:"\x3e\x3e",nextBigStatus:"\u663e\u793a\u4e0b\u4e00\u5e74",currentText:"\u4eca\u5929",currentStatus:"\u663e\u793a\u672c\u6708",monthNames:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),monthNamesShort:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),monthStatus:"\u9009\u62e9\u6708\u4efd",yearStatus:"\u9009\u62e9\u5e74\u4efd",weekHeader:"\u5468",weekStatus:"\u5e74\u5185\u5468\u6b21",dayNames:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" "),dayNamesShort:"\u5468\u65e5 \u5468\u4e00 \u5468\u4e8c \u5468\u4e09 \u5468\u56db \u5468\u4e94 \u5468\u516d".split(" "),dayNamesMin:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split(""),dayStatus:"\u8bbe\u7f6e DD \u4e3a\u4e00\u5468\u8d77\u59cb",dateStatus:"\u9009\u62e9 m\u6708 d\u65e5, DD",dateFormat:"yy-mm-dd",firstDay:1,initStatus:"\u8bf7\u9009\u62e9\u65e5\u671f",isRTL:!1};a.datepicker.setDefaults(a.datepicker.regional["zh-CN"]);a.widget("custom.catcomplete",a.ui.autocomplete,{_create:function(){this._super();this.widget().menu("option","items","\x3e :not(.ui-autocomplete-category)")},_renderMenu:function(b,c){var d=this,e="";a.each(c,function(a,c){var f;c.category!=e&&(b.append("\x3cli class\x3d'ui-autocomplete-category'\x3e"+c.category+"\x3c/li\x3e"),e=c.category);f=d._renderItemData(b,c);c.category&&f.attr("aria-label",c.category+" : "+c.label)})}})});util.autocomplete=function(a){var b={minLength:a.minLength,delay:a.delay,source:a.source||function(b,c){var d=b.term.split(/,\s*/).pop();if(a.urlsource.cache&&d in a.urlsource.cachedata)c(a.urlsource.cachedata[d]);else{var e=eval("("+a.urlsource.requestPara.format(d)+")");$.getJSON(a.urlsource.url,{sql:a.urlsource.sql,para:e},function(b,e,f){a.urlsource.cachedata[d]=b;c(b)})}},focus:function(){return!1},select:a.select||function(b,c){if(!a.multiple)return!0;var d=this.value.split(/,\s*/);d.pop();d.push(c.item.value);d.push("");this.value=d.join(", ");return!1}},c=$("#"+a.id);c.on("keydown",function(a){a.keyCode===$.ui.keyCode.TAB&&$(this).autocomplete("instance").menu.active&&a.preventDefault()});a.category?(c.catcomplete(b),a.renderitem&&(c.catcomplete("instance")._renderItem=a.renderitem)):(c.autocomplete(b),a.renderitem&&(c.autocomplete("instance")._renderItem=a.renderitem))};util.prefixZero=function(a,b){return(Array(b).join("0")+a).slice(-b)};util.getTime=function(){var a=new Date,b=a.getFullYear(),c=util.prefixZero(a.getMonth()+1,2),d=util.prefixZero(a.getDate(),2),e=util.prefixZero(a.getHours(),2),f=util.prefixZero(a.getMinutes(),2),a=util.prefixZero(a.getSeconds(),2);return b+"-"+c+"-"+d+" "+e+":"+f+":"+a};util.getDate=function(){var a=new Date,b=a.getFullYear(),c=util.prefixZero(a.getMonth()+1,2),a=util.prefixZero(a.getDate(),2);return b+"-"+c+"-"+a};util.urlToObject=function(a){var b={};if(/\?/.test(a)){a=a.substring(a.indexOf("?")+1).split("\x26");for(var c=0,d=a.length;c<d;c++){var e=a[c].split("\x3d");b[e[0]]=e[1]}return b}};util.getSystemInfo=function(a,b){LODOP.CVERSION&&(CLODOP.On_Return=function(a,c){b&&b(c)});var c=LODOP.GET_SYSTEM_INFO(a);return LODOP.CVERSION?"":c};util.CheckLodopIsInstall=function(){try{var a=getLodop();if(a.VERSION)return a.CVERSION?alert("\u5f53\u524d\u6709C-Lodop\u4e91\u6253\u5370\u53ef\u7528!\n C-Lodop\u7248\u672c:"+a.CVERSION+"(\u5185\u542bLodop"+a.VERSION+")"):alert("\u672c\u673a\u5df2\u6210\u529f\u5b89\u88c5\u4e86Lodop\u63a7\u4ef6\uff01\n \u7248\u672c\u53f7:"+a.VERSION),!0}catch(b){}return!1};util.getSelectOptionByText=function(a,b){return $(a+" option").map(function(){if($(this).text()==b)return this})};util.getSelectOptionByValue=function(a,b){return $(a+" option").map(function(){if($(this).val()==b)return this})};util.printerSetting={PrinterTypeKey:"",PrinterType:"",PrinterName:"",Orient:0,PageName:"",PageWidth:"",PageHeigth:""};util.PcSN="";util.bootstrapLodop=function(a,b){util.printerSetting.PrinterType=a;var c=window.setInterval(function(){"complete"===document.readyState&&((LODOP=getLodop())&&LODOP.GET_SYSTEM_INFO?(util.PcSN||(util.PcSN=$.cookie("PcSN")),util.PcSN||(util.PcSN=util.getSystemInfo("DiskDrive.1.SerialNumber",function(a){util.PcSN||(util.PcSN=a,$.cookie("PcSN",util.PcSN,{expires:180,path:"/"}))})),util.PcSN&&(window.clearInterval(c),util.printersetup(b))):window.clearInterval(c))},500)};util.printersetup=function(a){var b=("select * from printersetup where PcID \x3d '{PcID}' and printerType\x3d"+util.printerSetting.PrinterType).format({PcID:util.PcSN});$.getJSON(pageExt.libPath+"query.php",{sql:b},function(b,d,e){0<b.length&&(util.printerSetting.PrinterName=b[0].PrinterName,util.printerSetting.Orient=b[0].Orient,"#\u672a\u8bbe\u7f6e#"!=b[0].PageName&&(util.printerSetting.PageName=b[0].PageName),""!=b[0].PageWidth&&(util.printerSetting.PageWidth=b[0].PageWidth+"mm"),""!=b[0].PageHeigth&&(util.printerSetting.PageHeigth=b[0].PageHeigth+"mm"));a()})};util.printerchange=function(a){util.getSelectOptionByValue("#SelPrinterSet",util.printerSetting.PrinterType).attr("selected",!0);$("#SelPrinterSet").selectmenu({change:function(b,c){util.printerSetting.PrinterType=c.item.value;util.printersetup(a)}})};util.bootstrap=function(){0<$("#printerSel").length&&($.ajaxSetup({async:!1}),$("#printerSel").load(pageExt.libPath+"printerSel.php"),$.ajaxSetup({async:!0}));0<$("#SelPrinterSet").length&&($.cookie(util.printerSetting.PrinterTypeKey)?util.printerSetting.PrinterType=$.cookie(util.printerSetting.PrinterTypeKey):$.cookie(util.printerSetting.PrinterTypeKey,util.printerSetting.PrinterType,{expires:180,path:"/"}));util.bootstrapLodop(util.printerSetting.PrinterType,function(){util.printerSetting.PrinterName?$("#printerName").html(util.printerSetting.PrinterName):$("#printerName").html("#\u672a\u8bbe\u7f6e#");0<$("#SelPrinterSet").length&&util.printerchange(function(){util.printerSetting.PrinterName?$("#printerName").html(util.printerSetting.PrinterName):$("#printerName").html("#\u672a\u8bbe\u7f6e#");$.cookie(util.printerSetting.PrinterTypeKey,util.printerSetting.PrinterType,{expires:180,path:"/"})})})};util.initDialog=function(a){var b=$("#"+a.dialogID);0==b.length&&(b=$("\x3cdiv id\x3d'"+a.dialogID+"'\x3e\x3c/div\x3e").appendTo($("body")),a.context&&b.html(a.context));b.attr("initialized")||(a.countdown&&b.on("dialogopen",function(c,d){window.setTimeout(function(){b.dialog("close")},a.countdown)}),a.cfg&&b.dialog(a.cfg),b.attr("initialized",!0));return b};util.uuid=function(a,b){var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),d=[],e;b=b||c.length;if(a)for(e=0;e<a;e++)d[e]=c[0|Math.random()*b];else{var f;d[8]=d[13]=d[18]=d[23]="-";d[14]="4";for(e=0;36>e;e++)d[e]||(f=0|16*Math.random(),d[e]=c[19==e?f&3|8:f])}return d.join("")};