var util={};String.prototype.format=function(a){var c=this;if(0<arguments.length)if(1==arguments.length&&"object"==typeof a)for(var b in a){a[b]=a[b]?a[b]:"";var d=new RegExp("({"+b+"})","g"),c=c.replace(d,a[b])}else for(var e=0;e<arguments.length;e++)arguments[b]=arguments[b]?arguments[b]:"",d=new RegExp("({)"+e+"(})","g"),c=c.replace(d,arguments[e]);return c};$(function(a){a.fn.extend({alterBgColor:function(c){c=a.extend({style:"4",odd:"odd",even:"even",over:"over",selected:"selected"},c);a("tbody\x3etr:odd",this).addClass(c.odd);a("tbody\x3etr:even",this).addClass(c.even);a("tbody\x3etr",this).hover(function(){a(this).addClass(c.over)},function(){a(this).removeClass(c.over)});a("tbody\x3etr td:first-child:has(:checked)",this).parents("tr").addClass(c.selected);"1"==c.style&&a("tbody\x3etr",this).click(function(){a(this).toggleClass(c.selected)});"2"==c.style&&a("tbody\x3etr",this).click(function(){var b=a(this).hasClass(c.selected);a(this)[b?"removeClass":"addClass"](c.selected).find(":checkbox:first").prop("checked",!b)});"3"==c.style&&a("tbody\x3etr",this).click(function(){a(this).siblings().removeClass(c.selected);a(this).addClass(c.selected).find(":radio:first").prop("checked",!0)});"4"==c.style&&(a("tbody\x3etr td:first-child",this).click(function(){var b=a(this).parents("tr"),d=b.hasClass(c.selected);b[d?"removeClass":"addClass"](c.selected).find(":checkbox:first").prop("checked",!d)}),a("tbody\x3etr td:not(:first-child)",this).click(function(){var b=a(this).parents("tr");b.addClass(c.selected).siblings().removeClass(c.selected).find(":checkbox:first").prop("checked",!1);b.find(":checkbox:first").prop("checked",!0)}));a("thead\x3etr th:first-child :checkbox:first",this).click(function(){var b=a(this).prop("checked"),d=a(this).parents("table");d.find("tbody\x3etr")[b?"addClass":"removeClass"](c.selected);d.find("tbody\x3etr td:first-child :checkbox").prop("checked",b?!0:!1)});return this}});a(".gridtable").alterBgColor({style:"4"});a.datepicker.regional["zh-CN"]={clearText:"\u6e05\u9664",clearStatus:"\u6e05\u9664\u5df2\u9009\u65e5\u671f",closeText:"\u5173\u95ed",closeStatus:"\u4e0d\u6539\u53d8\u5f53\u524d\u9009\u62e9",prevText:"\x3c \u4e0a\u6708",prevStatus:"\u663e\u793a\u4e0a\u6708",prevBigText:"\x3c\x3c",prevBigStatus:"\u663e\u793a\u4e0a\u4e00\u5e74",nextText:"\u4e0b\u6708\x3e",nextStatus:"\u663e\u793a\u4e0b\u6708",nextBigText:"\x3e\x3e",nextBigStatus:"\u663e\u793a\u4e0b\u4e00\u5e74",currentText:"\u4eca\u5929",currentStatus:"\u663e\u793a\u672c\u6708",monthNames:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),monthNamesShort:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),monthStatus:"\u9009\u62e9\u6708\u4efd",yearStatus:"\u9009\u62e9\u5e74\u4efd",weekHeader:"\u5468",weekStatus:"\u5e74\u5185\u5468\u6b21",dayNames:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" "),dayNamesShort:"\u5468\u65e5 \u5468\u4e00 \u5468\u4e8c \u5468\u4e09 \u5468\u56db \u5468\u4e94 \u5468\u516d".split(" "),dayNamesMin:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split(""),dayStatus:"\u8bbe\u7f6e DD \u4e3a\u4e00\u5468\u8d77\u59cb",dateStatus:"\u9009\u62e9 m\u6708 d\u65e5, DD",dateFormat:"yy-mm-dd",firstDay:1,initStatus:"\u8bf7\u9009\u62e9\u65e5\u671f",isRTL:!1};a.datepicker.setDefaults(a.datepicker.regional["zh-CN"]);a.widget("custom.catcomplete",a.ui.autocomplete,{_create:function(){this._super();this.widget().menu("option","items","\x3e :not(.ui-autocomplete-category)")},_renderMenu:function(c,b){var d=this,e="";a.each(b,function(a,b){var f;b.category!=e&&(c.append("\x3cli class\x3d'ui-autocomplete-category'\x3e"+b.category+"\x3c/li\x3e"),e=b.category);f=d._renderItemData(c,b);b.category&&f.attr("aria-label",b.category+" : "+b.label)})}})});util.autocomplete=function(a){var c={minLength:a.minLength,delay:a.delay,source:a.source||function(b,c){var d=b.term.split(/,\s*/).pop();if(a.urlsource.cache&&d in a.urlsource.cachedata)c(a.urlsource.cachedata[d]);else{var e=eval("("+a.urlsource.requestPara.format(d)+")");$.getJSON(a.urlsource.url,{sql:a.urlsource.sql,para:e},function(b,e,f){a.urlsource.cachedata[d]=b;c(b)})}},focus:function(){return!1},select:a.select||function(b,c){if(!a.multiple)return!0;var d=this.value.split(/,\s*/);d.pop();d.push(c.item.value);d.push("");this.value=d.join(", ");return!1}},b=$("#"+a.id);b.on("keydown",function(a){a.keyCode===$.ui.keyCode.TAB&&$(this).autocomplete("instance").menu.active&&a.preventDefault()});a.category?(b.catcomplete(c),a.renderitem&&(b.catcomplete("instance")._renderItem=a.renderitem)):(b.autocomplete(c),a.renderitem&&(b.autocomplete("instance")._renderItem=a.renderitem))};util.prefixZero=function(a,c){return(Array(c).join("0")+a).slice(-c)};util.getTime=function(){var a=new Date,c=a.getFullYear(),b=util.prefixZero(a.getMonth()+1,2),d=util.prefixZero(a.getDate(),2),e=util.prefixZero(a.getHours(),2),f=util.prefixZero(a.getMinutes(),2),a=util.prefixZero(a.getSeconds(),2);return c+"-"+b+"-"+d+" "+e+":"+f+":"+a};util.getDate=function(){var a=new Date,c=a.getFullYear(),b=util.prefixZero(a.getMonth()+1,2),a=util.prefixZero(a.getDate(),2);return c+"-"+b+"-"+a};util.urlToObject=function(a){var c={};if(/\?/.test(a)){a=a.substring(a.indexOf("?")+1).split("\x26");for(var b=0,d=a.length;b<d;b++){var e=a[b].split("\x3d");c[e[0]]=e[1]}return c}};util.getSystemInfo=function(a,c){LODOP.CVERSION&&(CLODOP.On_Return=function(a,b){c&&c(b)});var b=LODOP.GET_SYSTEM_INFO(a);return LODOP.CVERSION?"":b};util.CheckLodopIsInstall=function(){try{var a=getLodop();if(a.VERSION)return a.CVERSION?alert("\u5f53\u524d\u6709C-Lodop\u4e91\u6253\u5370\u53ef\u7528!\n C-Lodop\u7248\u672c:"+a.CVERSION+"(\u5185\u542bLodop"+a.VERSION+")"):alert("\u672c\u673a\u5df2\u6210\u529f\u5b89\u88c5\u4e86Lodop\u63a7\u4ef6\uff01\n \u7248\u672c\u53f7:"+a.VERSION),!0}catch(c){}return!1};util.getSelectOptionByText=function(a,c){return $(a+" option").map(function(){if($(this).text()==c)return this})};util.getSelectOptionByValue=function(a,c){return $(a+" option").map(function(){if($(this).val()==c)return this})};util.printerSetting={PrinterTypeKey:"",PrinterType:"",PrinterName:"",Orient:0,PageName:"",PageWidth:"",PageHeigth:""};util.PcSN="";util.bootstrapLodop=function(a,c){util.printerSetting.PrinterType=a;var b=window.setInterval(function(){"complete"===document.readyState&&((LODOP=getLodop())&&LODOP.GET_SYSTEM_INFO?(util.PcSN||(util.PcSN=$.cookie("PcSN")),util.PcSN||(util.PcSN=util.getSystemInfo("DiskDrive.1.SerialNumber",function(a){util.PcSN||(util.PcSN=a,$.cookie("PcSN",util.PcSN,{expires:180,path:"/"}))})),util.PcSN&&(window.clearInterval(b),util.printersetup(c))):window.clearInterval(b))},500)};util.printersetup=function(a){var c=("select * from printersetup where PcID \x3d '{PcID}' and printerType\x3d"+util.printerSetting.PrinterType).format({PcID:util.PcSN});$.getJSON(pageExt.libPath+"query.php",{sql:c},function(b,c,e){0<b.length&&(util.printerSetting.PrinterName=b[0].PrinterName,util.printerSetting.Orient=b[0].Orient,"#\u672a\u8bbe\u7f6e#"!=b[0].PageName&&(util.printerSetting.PageName=b[0].PageName),""!=b[0].PageWidth&&(util.printerSetting.PageWidth=b[0].PageWidth+"mm"),""!=b[0].PageHeigth&&(util.printerSetting.PageHeigth=b[0].PageHeigth+"mm"));a()})};util.printerchange=function(a){util.getSelectOptionByValue("#SelPrinterSet",util.printerSetting.PrinterType).attr("selected",!0);$("#SelPrinterSet").selectmenu({change:function(c,b){util.printerSetting.PrinterType=b.item.value;util.printersetup(a)}})};util.bootstrap=function(){0<$("#printerSel").length&&($.ajaxSetup({async:!1}),$("#printerSel").load(pageExt.libPath+"printerSel.php"),$.ajaxSetup({async:!0}));0<$("#SelPrinterSet").length&&($.cookie(util.printerSetting.PrinterTypeKey)?util.printerSetting.PrinterType=$.cookie(util.printerSetting.PrinterTypeKey):$.cookie(util.printerSetting.PrinterTypeKey,util.printerSetting.PrinterType,{expires:180,path:"/"}));util.bootstrapLodop(util.printerSetting.PrinterType,function(){util.printerSetting.PrinterName?$("#printerName").html(util.printerSetting.PrinterName):$("#printerName").html("#\u672a\u8bbe\u7f6e#");0<$("#SelPrinterSet").length&&util.printerchange(function(){util.printerSetting.PrinterName?$("#printerName").html(util.printerSetting.PrinterName):$("#printerName").html("#\u672a\u8bbe\u7f6e#");$.cookie(util.printerSetting.PrinterTypeKey,util.printerSetting.PrinterType,{expires:180,path:"/"})})})};