var formExt={sqlCfg:{}};$(function(a){a(document).tooltip();formExt.pageIndexCtrl=a("#hidPageIndex")[0];a("td").focusin(function(){a(this).children("p").removeClass("breviary")});a("td").focusout(function(){$td=a(this);$p=$td.children("p[title]");$p.addClass("breviary");$p.prop("title",$td.text());var b=$td.attr("editSqlKey"),c=formExt.sqlCfg[b];if(c){var c=c.format({columnName:$td.attr("columnName")}),d={":value":$td.text()};if(b=$td.attr("editKey"))for(var b=b.split(","),e=0;e<b.length;e++){var f=b[e],g=$td.parent().children("[columnName\x3d'"+f+"']").text();d[":"+f]=g}a.post(formExt.libPath+"exec.php",{sql:c,para:d},function(a){a.success?console.log(a.msg+a.affectedCount):(console.log("\u4fdd\u5b58\u5931\u8d25\uff01"),console.log(c),console.log(d),console.log(a.msg))},"json")}})});formExt.doFristPage=function(){this.pageIndexCtrl.value=0};formExt.doPreviousPage=function(){var a=parseInt(this.pageIndexCtrl.value);0<a&&--a;this.pageIndexCtrl.value=a};formExt.doNextPage=function(){var a=parseInt(this.pageIndexCtrl.value);this.pageIndexCtrl.value=a+1};formExt.doPrint=function(){window.print()};formExt.exportExcel=function(){$("#mainGridTable").table2excel({name:document.title,filename:document.title+"_"+util.getTime(),fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0})};formExt.getSelectRecords=function(){var a=$("#mainGridTable\x3e tbody\x3etr td:first-child :checkbox:checked"),b="",c=[];a.each(function(){b+=$(this).val()+",";c.push($(this).val())});b=b.substring(0,b.length-1);return{selArr:c,selStr:b,tdRecords:a}};formExt.deleteRecords=function(){var a=formExt.getSelectRecords(),b=a.selStr;""==b?alert("\u8bf7\u9009\u4e2d\u8981\u5220\u9664\u7684\u8bb0\u5f55\uff01"):confirm("\u786e\u5b9a\u5220\u9664\u9009\u4e2d\u7684"+a.selArr.length+"\u6761\u8bb0\u5f55\u5417\uff1f")&&(formExt.deleteSql=formExt.sqlCfg.deleteSql.format(b),$.post(formExt.libPath+"exec.php",{sql:formExt.deleteSql},function(b){b.success?(console.log(b.msg+b.affectedCount),a.tdRecords.parents("tr").remove()):(console.log("\u5220\u9664\u5931\u8d25\uff01"),console.log(formExt.sqlCfg.deleteSql),console.log(b.msg))},"json"))};